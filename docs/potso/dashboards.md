# POTSO Abuse-Control Dashboards

The Grafana packs under `observability/grafana/dashboards/` already expose core
reward and participation metrics. This addendum explains how to visualise the
new abuse controls so operators can confirm they are functioning as intended.

## Configuration At A Glance

Add a small table panel that renders the live values returned by
`potso_params`. Surface the following parameters so governance decisions are
visible to everyone operating the dashboards:

- `potso.weights.MinStakeToWinWei`
- `potso.abuse.MinStakeToEarnWei`
- `potso.abuse.QuadraticTxDampenAfter`
- `potso.abuse.QuadraticTxDampenPower`
- `potso.abuse.MaxUserShareBps`

The RPC method already returns these fields, so a simple JSON datasource query
followed by field overrides is sufficient.

## Monitoring Stake Gating

Create a panel sourced from the leaderboard snapshot API that displays the
number of addresses filtered by the new `MinStakeToEarnWei` gate. A simple
stat-style card can be generated by counting entries where
`eligibleStake < MinStakeToEarnWei`. Plotting the ratio of gated entrants versus
active entrants over time makes it obvious when the threshold is tuned too
aggressively.

For deployments without custom collectors, expose the count via a recording rule
in Prometheus (for example, `potso_min_stake_gated_total`) and chart it alongside
`potso_epoch_pool` to correlate the impact on emissions.

## Tracking Quadratic Dampening

Overlay the raw transaction count and the dampened value derived from snapshots
on a dual-axis graph. The dampened value is computed with the formula from
`spec.md` and should flatten once `QuadraticTxDampenAfter` is exceeded. Sudden
divergence indicates either a configuration change or a potential regression in
the dampening implementation.

## Reward Share Cap Insight

`potso_rounding_dust` already tracks the residual budget per epoch. Combine it
with `potso_epoch_pool` and `sum(potso_rewards_sum)` to visualise how often
`MaxUserShareBps` is clipping large winners:

```
share_cap_remainder = potso_epoch_pool - sum(potso_rewards_sum)
```

Plot this alongside the percentage `share_cap_remainder / potso_epoch_pool` to
highlight epochs where significant redistribution occurred. Pair the panel with a
table listing the top N winners from `potso_rewards` so treasury operators can
quickly audit deterministic redistribution.

## Alerting Suggestions

Extend the existing Prometheus rules with alerts that trigger when:

- The gated participant count exceeds a configured ceiling for a sustained
  period (e.g. more than 10% of entrants for 6 hours).
- The share-cap remainder spikes above an agreed threshold, which could signal a
  concentrated attack or a misconfigured cap.

Keeping these dashboards up to date gives operations real-time confidence that
the new guardrails are holding without degrading legitimate participation.
